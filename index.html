<!doctype html>
<html lang="en-AU">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>SmartLearning — Asset Gallery</title>
    <link rel="manifest" href="/manifest.webmanifest" />
    <link rel="stylesheet" href="/css/styles.css" />
    <style>
      /* small gallery overrides */
      body {
        background: linear-gradient(180deg, #0f1724 0%, #0b1220 100%);
      }
      .gallery-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
        gap: 1rem;
      }
      .asset-card {
        text-align: center;
        padding: 1rem;
      }
      .asset-thumb {
        width: 160px;
        height: 90px;
        object-fit: contain;
        border-radius: 12px;
        border: 1px solid rgba(255, 255, 255, 0.06);
        background: rgba(255, 255, 255, 0.02);
      }
      .md-preview {
        white-space: pre-wrap;
        background: rgba(255, 255, 255, 0.02);
        padding: 1rem;
        border-radius: 12px;
        overflow: auto;
        max-height: 60vh;
      }
      header.app-header {
        background: linear-gradient(90deg, #061426, #0b1830);
      }
    </style>
  </head>
  <body class="large-text">
    <header class="app-header">
      <div class="header-inner container">
        <div class="header-title-group">
          <h1 class="heading">Asset gallery — SmartLearning</h1>
          <p class="text-muted">
            Preview and spec for visual assets (hand-off-ready).
          </p>
        </div>
        <div class="header-actions">
          <a
            class="btn btn-ghost"
            href="https://nerdedi.github.io/smartlearning/"
            target="_blank"
            >View live app</a
          >
          <a class="btn btn-primary" href="/game/index.html">Open Game</a>
          <a
            class="btn btn-accent"
            id="download-spec"
            href="/gallery.md"
            download
            >Download spec</a
          >
        </div>
      </div>
    </header>

    <main class="container" role="main" style="padding: 1.25rem 1rem">
      <section class="card">
        <h2 class="h2">World thumbnails</h2>
        <div id="worlds" class="gallery-grid" aria-live="polite"></div>
      </section>

      <section
        class="card"
        style="
          margin-top: 1rem;
          display: flex;
          gap: 1rem;
          align-items: flex-start;
        "
      >
        <div style="flex: 1">
          <h2 class="h2">UI icons & components</h2>
          <div class="grid grid-3" id="ui-assets" style="gap: 0.75rem"></div>
        </div>
        <aside style="width: 420px">
          <h3 class="h3">Gallery spec (preview)</h3>
          <div id="md-preview" class="md-preview">Loading spec…</div>
        </aside>
      </section>
    </main>

    <footer
      class="container text-muted"
      style="padding: 1rem 0; text-align: center"
    >
      <small
        >Place finished assets in <code>/assets/</code> using the names in
        <code>gallery.md</code>.</small
      >
    </footer>

    <script type="module">
      import { GALLERY_DATA } from './modules-data.js'

      const worldsEl = document.getElementById('worlds')
      GALLERY_DATA.worlds.forEach((w) => {
        const card = document.createElement('div')
        card.className = 'card asset-card card-clickable'
        card.innerHTML = `
          <img class="asset-thumb" src="${w.thumb}" alt="${w.name} thumbnail" onerror="this.style.opacity=.3">
          <h4 style="margin-top:.5rem">${w.icon} ${w.name}</h4>
          <p class="text-muted" style="font-size:.9rem">Levels: ${w.levels.length}</p>`
        worldsEl.appendChild(card)
      })

      const uiIcons = [
        'icon-play',
        'icon-pause',
        'icon-settings',
        'icon-help',
        'icon-export',
        'icon-badge',
        'icon-star',
      ]
      const uiEl = document.getElementById('ui-assets')
      uiIcons.forEach((id) => {
        const el = document.createElement('div')
        el.className = 'card asset-card'
        el.innerHTML = `<img src="/assets/icons/icon-192x192.png" alt="${id}" style="width:64px;height:64px"><div style="margin-top:.5rem;font-weight:700;font-size:.9rem">${id}</div>`
        uiEl.appendChild(el)
      })

      fetch('/gallery.md')
        .then((r) => r.text())
        .then((md) => {
          document.getElementById('md-preview').innerHTML = mdToHtml(md)
        })
        .catch(() => {
          document.getElementById('md-preview').textContent =
            'gallery.md not found'
        })

      function mdToHtml(md) {
        return md
          .replace(/^### (.*$)/gim, '<h4>$1</h4>')
          .replace(/^## (.*$)/gim, '<h3>$1</h3>')
          .replace(/^# (.*$)/gim, '<h2>$1</h2>')
          .replace(/\*\*(.*?)\*\*/gim, '<strong>$1</strong>')
          .replace(/\n- (.*?)(?=\n|$)/gim, '<li>$1</li>')
          .replace(/(\n){2,}/gim, '<p></p>')
          .replace(/<li>(.*?)<\/li>/gim, '<ul><li>$1</li></ul>')
      }
    </script>
  </body>
</html>
