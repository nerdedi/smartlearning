<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Sprite Calibration Tool</title>
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: #1a1a2e;
      color: #eee;
      padding: 20px;
    }
    h1 { text-align: center; margin-bottom: 10px; color: #4cc9f0; }
    .instructions {
      text-align: center;
      margin-bottom: 20px;
      color: #aaa;
      font-size: 14px;
    }
    .full-image {
      text-align: center;
      margin-bottom: 30px;
      position: relative;
    }
    .full-image img {
      max-width: 100%;
      height: auto;
      border: 2px solid #333;
    }
    .full-image h2 {
      margin-bottom: 10px;
      color: #f72585;
    }

    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 20px;
      margin-bottom: 30px;
    }
    .item {
      background: #16213e;
      border-radius: 12px;
      padding: 15px;
      border: 2px solid #333;
    }
    .item h3 {
      color: #4cc9f0;
      margin-bottom: 10px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .item h3 span {
      font-size: 12px;
      color: #888;
      font-weight: normal;
    }
    .preview-container {
      position: relative;
      display: inline-block;
      background: #fafafa;
      border: 3px dashed #f72585;
      margin-bottom: 15px;
    }
    .preview-container canvas {
      display: block;
    }

    .controls {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 8px;
    }
    .control-group {
      display: flex;
      align-items: center;
      gap: 8px;
    }
    .control-group label {
      width: 25px;
      font-weight: bold;
      color: #4cc9f0;
    }
    .control-group input {
      width: 70px;
      padding: 6px;
      border: 1px solid #555;
      border-radius: 4px;
      background: #0f0f23;
      color: #fff;
      font-size: 14px;
    }
    .control-group button {
      padding: 6px 10px;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-size: 12px;
    }
    .btn-minus { background: #e74c3c; color: white; }
    .btn-plus { background: #2ecc71; color: white; }

    .export-section {
      background: #16213e;
      border-radius: 12px;
      padding: 20px;
      margin-top: 30px;
    }
    .export-section h2 {
      color: #f72585;
      margin-bottom: 15px;
    }
    .export-section textarea {
      width: 100%;
      height: 300px;
      background: #0f0f23;
      color: #4cc9f0;
      border: 1px solid #555;
      border-radius: 8px;
      padding: 15px;
      font-family: 'Monaco', 'Menlo', monospace;
      font-size: 12px;
    }
    .export-section button {
      margin-top: 10px;
      padding: 12px 24px;
      background: #4cc9f0;
      color: #0f0f23;
      border: none;
      border-radius: 8px;
      font-weight: bold;
      cursor: pointer;
      font-size: 16px;
    }
    .export-section button:hover {
      background: #3aa8d8;
    }
  </style>
</head>
<body>
  <h1>üîß Sprite Calibration Tool</h1>
  <p class="instructions">Adjust X, Y, Width, Height for each currency item until it's perfectly cropped. The dashed pink border shows the crop area.</p>

  <div class="full-image">
    <h2>Full Sprite Sheet (1536 √ó 1024)</h2>
    <img src="assets/money/windgap-currency.png" alt="Full sprite sheet" id="sourceImage">
  </div>

  <h2 style="color: #f72585; margin-bottom: 15px;">üìù Notes</h2>
  <div class="grid" id="notes-grid"></div>

  <h2 style="color: #f72585; margin-bottom: 15px;">ü™ô Coins</h2>
  <div class="grid" id="coins-grid"></div>

  <div class="export-section">
    <h2>üìã Export Coordinates</h2>
    <p style="color: #aaa; margin-bottom: 10px;">Copy this code and paste it into moneygame.js to replace the SPRITE_REGIONS object:</p>
    <textarea id="exportCode" readonly></textarea>
    <button onclick="copyToClipboard()">üìã Copy to Clipboard</button>
  </div>

  <script>
    // Current sprite regions (auto-calibrated)
    const regions = {
      note5:   { x: 27,   y: 120, w: 466, h: 260 },
      note10:  { x: 516,  y: 120, w: 503, h: 260 },
      note20:  { x: 1022, y: 120, w: 484, h: 260 },
      note50:  { x: 516,  y: 380, w: 467, h: 300 },
      note100: { x: 999,  y: 380, w: 508, h: 300 },
      coin5c:  { x: 92,   y: 701, w: 167, h: 168 },
      coin10c: { x: 276,  y: 697, w: 173, h: 175 },
      coin20c: { x: 460,  y: 693, w: 184, h: 185 },
      coin50c: { x: 655,  y: 680, w: 220, h: 203 },
      coin1:   { x: 893,  y: 680, w: 218, h: 209 },
      coin2:   { x: 1125, y: 693, w: 194, h: 192 },
    };

    const labels = {
      note5: '$5 Note',
      note10: '$10 Note',
      note20: '$20 Note',
      note50: '$50 Note',
      note100: '$100 Note',
      coin5c: '5c Coin',
      coin10c: '10c Coin',
      coin20c: '20c Coin',
      coin50c: '50c Coin',
      coin1: '$1 Coin',
      coin2: '$2 Coin',
    };

    let img = null;
    const canvases = {};

    document.getElementById('sourceImage').onload = function() {
      img = this;
      initUI();
      updateAllPreviews();
      updateExportCode();
    };

    function initUI() {
      const notesGrid = document.getElementById('notes-grid');
      const coinsGrid = document.getElementById('coins-grid');

      Object.keys(regions).forEach(id => {
        const isNote = id.startsWith('note');
        const container = isNote ? notesGrid : coinsGrid;
        const r = regions[id];

        const item = document.createElement('div');
        item.className = 'item';
        item.innerHTML = `
          <h3>${labels[id]} <span>${id}</span></h3>
          <div class="preview-container">
            <canvas id="canvas-${id}"></canvas>
          </div>
          <div class="controls">
            <div class="control-group">
              <label>X:</label>
              <button class="btn-minus" onclick="adjust('${id}', 'x', -5)">-5</button>
              <input type="number" id="${id}-x" value="${r.x}" onchange="updateFromInput('${id}')">
              <button class="btn-plus" onclick="adjust('${id}', 'x', 5)">+5</button>
            </div>
            <div class="control-group">
              <label>Y:</label>
              <button class="btn-minus" onclick="adjust('${id}', 'y', -5)">-5</button>
              <input type="number" id="${id}-y" value="${r.y}" onchange="updateFromInput('${id}')">
              <button class="btn-plus" onclick="adjust('${id}', 'y', 5)">+5</button>
            </div>
            <div class="control-group">
              <label>W:</label>
              <button class="btn-minus" onclick="adjust('${id}', 'w', -5)">-5</button>
              <input type="number" id="${id}-w" value="${r.w}" onchange="updateFromInput('${id}')">
              <button class="btn-plus" onclick="adjust('${id}', 'w', 5)">+5</button>
            </div>
            <div class="control-group">
              <label>H:</label>
              <button class="btn-minus" onclick="adjust('${id}', 'h', -5)">-5</button>
              <input type="number" id="${id}-h" value="${r.h}" onchange="updateFromInput('${id}')">
              <button class="btn-plus" onclick="adjust('${id}', 'h', 5)">+5</button>
            </div>
          </div>
        `;
        container.appendChild(item);
        canvases[id] = document.getElementById(`canvas-${id}`);
      });
    }

    function updatePreview(id) {
      const canvas = canvases[id];
      const ctx = canvas.getContext('2d');
      const r = regions[id];

      // Scale down for display
      const scale = id.startsWith('note') ? 0.5 : 0.8;
      const displayW = Math.round(r.w * scale);
      const displayH = Math.round(r.h * scale);

      canvas.width = displayW;
      canvas.height = displayH;

      ctx.clearRect(0, 0, displayW, displayH);
      ctx.drawImage(img, r.x, r.y, r.w, r.h, 0, 0, displayW, displayH);
    }

    function updateAllPreviews() {
      Object.keys(regions).forEach(updatePreview);
    }

    function adjust(id, prop, delta) {
      regions[id][prop] += delta;
      document.getElementById(`${id}-${prop}`).value = regions[id][prop];
      updatePreview(id);
      updateExportCode();
    }

    function updateFromInput(id) {
      regions[id].x = parseInt(document.getElementById(`${id}-x`).value) || 0;
      regions[id].y = parseInt(document.getElementById(`${id}-y`).value) || 0;
      regions[id].w = parseInt(document.getElementById(`${id}-w`).value) || 100;
      regions[id].h = parseInt(document.getElementById(`${id}-h`).value) || 100;
      updatePreview(id);
      updateExportCode();
    }

    function updateExportCode() {
      const W = img?.naturalWidth || 1536;
      const H = img?.naturalHeight || 1024;
      const lines = [];

      // JS export for moneygame.js
      lines.push('/* ---- Paste into moneygame.js ---- */');
      lines.push('  const SPRITE_REGIONS = {');
      const ids = Object.keys(regions);
      ids.forEach((id, i) => {
        const r = regions[id];
        const pad = id.length < 7 ? ' '.repeat(7 - id.length) : '';
        const comma = i < ids.length - 1 ? ',' : '';
        lines.push(`    ${id}:${pad} { x: ${r.x}, y: ${r.y}, w: ${r.w}, h: ${r.h} }${comma}`);
      });
      lines.push('  };');
      lines.push('');

      // CSS export for styles.css
      lines.push('/* ---- Paste into styles.css ---- */');
      ids.forEach(id => {
        const r = regions[id];
        const pad = id.length < 7 ? ' '.repeat(7 - id.length) : '';
        lines.push(`.spr-${id}${pad} { --spr-x: ${r.x}; --spr-y: ${r.y}; --spr-w: ${r.w}; --spr-h: ${r.h}; }`);
      });

      document.getElementById('exportCode').value = lines.join('\n');
    }

    function copyToClipboard() {
      const textarea = document.getElementById('exportCode');
      textarea.select();
      document.execCommand('copy');
      alert('Copied to clipboard!');
    }
  </script>
</body>
</html>
